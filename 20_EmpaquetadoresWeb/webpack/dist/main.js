(()=>{"use strict";const e={trendingEntries:document.querySelector(".trending_carousel-entries"),trendingBullets:document.querySelector(".trending_carousel-bullets"),fillBanner:document.querySelector(".fillBanner_img"),fillBannerCategories:document.querySelector(".fillBanner_categories"),contentSummary:document.querySelector(".contentSummary"),contentCategories:document.querySelector(".contentSummary-categories"),genreSelect:document.querySelector(".genre_select-genre"),categorySelect:document.querySelector(".genre_select-categories"),popover:document.getElementById("popover"),home:document.querySelector(".home"),filmBanner:document.querySelector(".filmBanner"),navbarCategories:document.querySelector(".navbar_categories"),allFilms:document.querySelector("#allFilms"),searchFilms:document.querySelector("#search"),filmDetails:document.querySelector("#filmDetails"),navBar:document.querySelector(".navbar_container"),search:document.querySelector(".navbar_search"),navbar:document.querySelector(".navbar_logo-button"),genre:document.querySelector(".genre_button"),trending:document.querySelector(".trending_button"),trendingTitle:document.querySelector(".trending_title"),selectGenre:document.querySelector(".genre_select-genre"),selectCategories:document.querySelector(".genre_select-categories"),genreContent:document.querySelector(".genre_content"),allFilmsTitle:document.querySelector(".allFilms_title"),allFilmsContainer:document.querySelector(".allFilms_container"),searchFormInput:document.querySelector(".search_form-input"),searchButton:document.querySelector(".search_button"),searchContainer:document.querySelector(".search_container"),detailsTitle:document.querySelector(".details_title"),detailsReview:document.querySelector(".details_review p"),detailsDescription:document.querySelector(".details_description p"),detailsCategories:document.querySelector(".details_categories ul"),detailsFilmsSimilar:document.querySelector(".details_filmsSimilar"),detailsImg:document.querySelector(".details_img"),returnPopover:document.querySelector(".return_popover"),loaderBanner:document.querySelector(".loaderBanner"),trendingCarouselLoader:document.querySelector(".trending_carousel-loader"),genreContentLoader:document.querySelector(".genre_content-loader "),endFilms:document.querySelector("#endOfContentFilms"),endSearch:document.querySelector("#endOfContentSearch"),favoriteFilms:document.querySelector("#favoriteFilms"),favoriteContainer:document.querySelector(".favorite_gallery"),languageOptions:document.querySelector("#languageOptions")},t=e.languageOptions,n=()=>{let e=localStorage.getItem("lang")?localStorage.getItem("lang"):navigator.language||"en-US";return t.addEventListener("change",(t=>{e=t.target.value,location.reload(),localStorage.setItem("lang",t.target.value)})),t.value=e,localStorage.setItem("lang",e),e},a="https://api.themoviedb.org/3",r="eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIwOWExMjY3YjA5ZWM0MTI3NGIyMThhYzQ1NjEzYjBkZSIsInN1YiI6IjY1Yzk0MWJjNDM1MDExMDE2MmU4NjY1NCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.8_uZTnW8jt5cps4n7JKlvMH94xpEuT8h_xMBnv72C80",i="https://image.tmdb.org/t/p/original/",o="https://generative-ai-ultisaer.s3.sa-east-1.amazonaws.com/images/foggy_forest_not_found.png",s=()=>{const e=location.hash;e.startsWith("#allFilms")?l():e.startsWith("#filmDetails")||(e.startsWith("#searchFilms")?c():e.startsWith("#filmPreview")?m():e.startsWith("#carousel")?u():"#allFilms_Trending"===e?console.log("trendingInfiniteScroll"):"#allFilms_Genre"===e?console.log("genreInfiniteScroll"):d())},l=()=>{window.scrollTo(0,0),e.home.classList.add("inactive"),e.favoriteFilms.classList.add("inactive"),e.filmBanner.classList.add("inactive"),e.navbarCategories.classList.add("inactive"),e.filmDetails.classList.add("inactive"),e.searchFilms.classList.add("inactive"),e.allFilms.classList.remove("inactive"),e.navBar.classList.remove("inactive")},c=()=>{window.scrollTo(0,0),e.home.classList.add("inactive"),e.favoriteFilms.classList.add("inactive"),e.filmBanner.classList.add("inactive"),e.navbarCategories.classList.add("inactive"),e.allFilms.classList.add("inactive"),e.searchFilms.classList.remove("inactive"),e.filmDetails.classList.add("inactive"),e.navBar.classList.add("inactive")},d=()=>{window.scrollTo(0,0),e.home.classList.remove("inactive"),e.favoriteFilms.classList.remove("inactive"),e.filmBanner.classList.remove("inactive"),e.navbarCategories.classList.remove("inactive"),e.searchFilms.classList.add("inactive"),e.allFilms.classList.add("inactive"),e.navBar.classList.remove("inactive"),e.filmDetails.classList.add("inactive")},m=()=>{window.scrollTo(0,0),popover.showPopover()},u=()=>{window.scrollTo({top:200})},g=axios.create({baseURL:a,headers:{Authorization:`Bearer ${r}`},params:{language:n()}}),v={method:"GET",headers:{Authorization:`Bearer ${r}`}},h=["Series","Films"],p=e.genre,S=()=>{p.value=`${e.selectGenre.textContent} / ${e.selectCategories.textContent}`};h.forEach((t=>{const n=e.contentSummary,a=document.createElement("p");a.textContent=t,n.append(a),(t=>{const n=e.genreSelect;t.addEventListener("click",(e=>{const t=e.target.textContent;e.target.textContent!==n.textContent&&(n.textContent=t,S())}))})(a)}));const y=new IntersectionObserver((e=>{e.forEach((e=>{if(e.isIntersecting){const t=e.target.getAttribute("data-src");e.target.src=t}}))})),f=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting}))})),_=e.endFilms;f.observe(_);const L=e.favoriteContainer,C=e=>{if(e){const t=Object.values(e);L.innerHTML="",b(t,L)}},E=()=>localStorage.getItem("likedFilm")?localStorage.getItem("likedFilm"):"{}";window.addEventListener("DOMContentLoaded",(()=>{const e=JSON.parse(localStorage.getItem("likedFilm"));C(e)}),!1);const F=(t,n)=>{t.addEventListener("click",(()=>{popover.showPopover(),location.hash=n,(async t=>{const{data:n}=await g("movie/"+t),a=e.detailsImg;a.innerHTML="";const r=document.createElement("img"),s=null===n.poster_path?o:`${i}${n.poster_path}`;r.src=s,r.className="image",r.alt=n.title,a.append(r),e.detailsTitle.textContent=n.title,e.detailsReview.textContent=n.vote_average,e.detailsDescription.textContent=n.overview;const l=e.detailsCategories;l.innerHTML="",n.genres.forEach((e=>{const t=document.createElement("li");t.textContent=e.name,l.append(t)})),(async t=>{const{data:n}=await g(`movie/${t}/similar`),a=n.results,r=e.detailsFilmsSimilar;r.innerHTML="",b(a,r)})(t)})(t.value)}))},w=({data:e,isLazy:t=!0})=>{const n=document.createElement("img");n.alt=e.title,n.draggable=!1,n.className="image",n.value=e.id,n.setAttribute("popovertarget","popover");const a=(e=>e.poster_path?i+e.poster_path:o)(e);return((e,t,n)=>{n?e.setAttribute("data-src",t):e.src=t})(n,a,t),n},q=JSON.parse(E()),b=(e,t,n=!0)=>{e.forEach((e=>{const a=document.createElement("div"),r=w({data:e,isLazy:n}),i=(e=>{const t=document.createElement("button"),n=document.createElement("img");return n.src="../media/hearth.svg",t.className="favorite_button",t.append(n),((e,t,n)=>{void 0!==q[n.id]&&(t.src="../media/hearthSelect.svg",e.classList.add("favorite_button-liked")),e.addEventListener("click",(()=>{e.classList.toggle("favorite_button-liked"),e.classList.contains("favorite_button-liked")?t.src="../media/hearthSelect.svg":t.src="../media/hearth.svg",(e=>{const t=JSON.parse(E());void 0!==e.id&&(t[e.id]?delete t[e.id]:t[e.id]=e,localStorage.setItem("likedFilm",JSON.stringify(t)),C(JSON.parse(localStorage.getItem("likedFilm"))))})(n)}))})(t,n,e),t})(e);a.style.position="relative",a.append(r),a.append(i),t.append(a),F(r,`filmPreview_${e.id}`),n&&y.observe(r)}))};n();const I="day",T={};(async()=>{const t=e.trendingEntries,n=e.trendingBullets,{data:a}=await g(`/trending/movie/${I}`),r=a.results,i=Math.floor(Math.random()*r.length);x(r[i]),((e,t,n)=>{let a=0;e.forEach(((r,i)=>{if(i%2!=0){a++;const r=document.createElement("li"),o=document.createElement("a");o.name=`carousel_${a.toString().padStart(2,"0")}`;const s=t=>{const n=e[t],a=w({data:n});return F(a,`filmPreview_${n.id}`),y.observe(a),a},l=s(i-1),c=s(i);o.append(l,c),r.append(o),t.append(r);const d=document.createElement("li"),m=document.createElement("a");m.href=`#carousel_${a.toString().padStart(2,"0")}`,d.append(m),n.append(d)}}))})(r,t,n),k(),e.trendingCarouselLoader.style.display="none"})();const x=t=>{const n=e.fillBanner;n.innerHTML="",b([t],n,!0),B(t.genre_ids)},B=async t=>{const{data:n}=await g("/genre/movie/list"),a=e.fillBannerCategories;t.forEach((e=>{n.genres.forEach((({id:t,name:n})=>{if(t===e){const e=document.createElement("p");e.innerText=n,a.append(e)}}))}))},M=()=>{const t=document.querySelectorAll(".genre_categories .contentSummary-categories p"),n=e.categorySelect;t.forEach((e=>{e.addEventListener("click",(e=>{e.stopPropagation();const t=e.target.textContent;n.textContent=t,H()}))}))},k=()=>{const t=document.querySelectorAll(".trending_carousel-entries li a img"),n=e.popover;t.forEach((e=>{e.addEventListener("click",(t=>{const a=e.value;n.showPopover(),location.hash=`filmPreview_${e.value}`,X(a)}))}))};(async()=>{const t=e.contentCategories,n=await fetch(`${a}/genre/movie/list?`,v);(await n.json()).genres.forEach((e=>{const n=document.createElement("p");n.textContent=e.name,t.append(n),T[e.name]=e.id})),H(),M()})(),window.addEventListener("DOMContentLoaded",s,!1),window.addEventListener("hashchange",s,!1),document.querySelectorAll(".allFilms_button").forEach((e=>{e.addEventListener("click",(()=>{location.hash="#allFilms"}))}));const $=e.navbar,O=e.returnPopover,N=document.querySelectorAll(".return_hash");$.addEventListener("click",(()=>{location.hash="#home"})),O.addEventListener("click",(()=>{history.back()})),N.forEach((e=>{e.addEventListener("click",(()=>{history.back()}))})),e.search.addEventListener("click",(()=>{location.hash="#searchFilms"})),document.querySelectorAll(".button_play").forEach((e=>{e.addEventListener("click",(()=>{}))}));const W=e.genre,J=e.trending,D=e.trendingTitle.textContent;J.value=D;const H=()=>{W.value=`${e.selectGenre.textContent} / ${e.selectCategories.textContent}`,j()},j=async()=>{const[e,t]=W.value.split("/ "),n=T[t],a=await g("discover/movie",{params:{with_genres:n}});P=a.data.total_pages;const r=a.data.results;A(r),G(r)},A=t=>{const n=e.genreContent;n.innerHTML="";const a=t.slice(0,6);b(a,n),e.genreContentLoader.style.display="none"},G=t=>{const n=e.allFilmsTitle,a=e.allFilmsContainer;n.textContent=W.value,a.innerHTML="",b(t,a)};let P;J.addEventListener("click",(()=>{(async()=>{const{data:t}=await g(`/trending/movie/${I}`);P=t.total_pages;const n=t.results,a=e.allFilmsTitle,r=e.allFilmsContainer;a.textContent=J.value,r.innerHTML="",b(n,r)})(),location.hash="#allFilms_Trending"})),W.addEventListener("click",(()=>{j(),location.hash=`#allFilms_Genre-${allFilms.textContent.split("/ ")[1]?.trim()}`}));let z=1;new IntersectionObserver((e=>{e.forEach((e=>{if(e.isIntersecting){const t=e.target.getAttribute("data-src");e.target.src=t}}))}));const Y=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&Q()}))})),R=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&Q()}))})),U=e.endFilms,Z=e.endSearch;Y.observe(U),R.observe(Z);const Q=async()=>{const t=e.allFilmsTitle,n=z<P;let a="";if("#allFilms_Trending"===location.hash?a="Trending":location.hash.startsWith("#searchFilms")?a="Search":location.hash.startsWith("#allFilms_Genre")&&(a="Genre"),n){if("Trending"===a&&n){const{data:t}=await g(`trending/movie/${I}`,{params:{page:z++}}),n=t.results,a=e.allFilmsTitle,r=e.allFilmsContainer;a.textContent=J.value,b(n,r)}else if("Genre"===a&&n){const[n,a]=t.textContent.split("/ "),r=T[a],i=(await g("discover/movie",{params:{with_genres:r,page:z++}})).data.results,o=e.allFilmsTitle,s=e.allFilmsContainer;o.textContent=W.value,b(i,s)}else if("Search"===a&&n){const t=e.searchFormInput,{data:n}=await g("search/movie",{params:{query:t.value,page:z++}}),a=e.searchContainer;b(n.results,a)}}else console.log("Es el maximo chamo")},K=e.searchFormInput;e.searchButton.addEventListener("click",(()=>{location.hash=`#searchFilms_${K.value}`,V(K.value)}));const V=async t=>{const{data:n}=await g("search/movie",{params:{query:t}}),a=e.searchContainer;a.innerHTML="",b(n.results,a)},X=async t=>{const{data:n}=await g("movie/"+t),a=e.detailsImg;a.innerHTML="";const r=document.createElement("img"),s=null===n.poster_path?o:`${i}${n.poster_path}`;r.src=s,r.className="image",r.alt=n.title,a.append(r),e.detailsTitle.textContent=n.title,e.detailsReview.textContent=n.vote_average,e.detailsDescription.textContent=n.overview;const l=e.detailsCategories;l.innerHTML="",n.genres.forEach((e=>{const t=document.createElement("li");t.textContent=e.name,l.append(t)})),ee(t)},ee=async t=>{const{data:n}=await g(`movie/${t}/similar`),a=n.results,r=e.detailsFilmsSimilar;r.innerHTML="",b(a,r)};if(location.hash.startsWith("#filmPreview")){const e=location.hash.split("_")[1];X(e)}window.addEventListener("hashchange",(()=>{if((()=>{const e=decodeURI(location.hash.split("_")[1]);"undefined"!==e?(K.value=e,V(K.value)):(K.value="",V(K.value))})(),location.hash.startsWith("#filmPreview")){const e=location.hash.split("_")[1];X(e)}}))})();